<!DOCTYPE html>
<html>
<head>
    <title>CS458 HW3</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 20;
        padding: 0;
      }
    </style>
    <link href="jQueryAssets/jquery.ui.core.min.css" rel="stylesheet" type="text/css">
    <link href="jQueryAssets/jquery.ui.theme.min.css" rel="stylesheet" type="text/css">
    <link href="jQueryAssets/jquery.ui.button.min.css" rel="stylesheet" type="text/css">
<script src="jQueryAssets/jquery-1.11.1.min.js"></script>
<script src="jQueryAssets/jquery.ui-1.10.4.button.min.js"></script>
</head>
  <body>
    
    <div id="test"> 
     
        
		<form>
			CoordinateX:<br>
			 <input type="text" id="Xcoor" name="Xcoor"> <br>
			 CoordinateY:<br>
		  <input type="text" id="Ycoor" name="Ycoor"> <br>
		</form>
		 <form>
			 <input type="button" onClick="where()" value="Where am I?" />
		</form>
	  <p id="location" > Your location is </p>
		<p id="current">For your devices location click </p>
		<form>
			 <input type="button" onClick="currentLocation()" value="Get current location" />
		</form>
		<p>Please click "Get Current Location" button before clicking "How far..." buttons.</p>
		<p>Click the button and see how far you away from the nearest city center. </p>
		<form>
			 <input type="button" onClick="distanceToCity()" value="How far I am to the nearest city center?" />
		</form>
	  <p id="location2" > You are far from the city center </p>
		<form>
			 <input type="button" onClick="distanceToEarth()" value="How far I am to the earth center?" />
		</form>
	  <p id="location3" > You are far from the earth center </p>
    </div>
    <div id="map"></div>
    <script>
		var map;
		var geocoder;
		var adress;
      	function initMap() {
			geocoder = new google.maps.Geocoder();
        	map = new google.maps.Map(document.getElementById('map'), {
          		center: {lat: -34.397, lng: 150.644},
          		zoom: 8
			});
		
      	}
		
		function where() {
			var myDiv = document.getElementById("test");
			var location = document.getElementById("location");
			location.innerHTML = "Your location is unknown!" + document.getElementById("Xcoor").value + "---" + document.getElementById("Ycoor").value 	;
			var myLL = new google.maps.LatLng( document.getElementById("Xcoor").value, document.getElementById("Ycoor").value);
			map = new google.maps.Map(document.getElementById('map'), {
          	center: myLL,
          	zoom: 8
        	});
			
			var address = document.getElementById( 'Xcoor').value + "," + document.getElementById( 'Ycoor').value;
			geocoder.geocode( { 'address' : address}, function( results, status) {
				if(status == 'OK') {
					map.setCenter(results[0].geometry.location);
					location.innerHTML = "Your location is " + results[0].formatted_address;
					adress = results[0].formatted_address;
					var marker = new google.maps.Marker( {
					map: map,
            		position: results[0].geometry.location
					});
				} else {
					alert('Geocode failed: ' + status);
				}
			});
			

      	}
		
		var currentLocationn;
		function currentLocation() {
			var pos;
			if (navigator.geolocation) {
			  	navigator.geolocation.getCurrentPosition(function(position) {
				pos = {lat: position.coords.latitude, lng: position.coords.longitude};
				currentLocationn = pos;
	//            infoWindow.setPosition(pos);
	//            infoWindow.setContent('Location found.');
	//            infoWindow.open(map);
				map.setCenter(pos);
				var marker = new google.maps.Marker( {
					map: map,
					position: pos
				});
			   }, function() {
				handleLocationError(true, infoWindow, map.getCenter());
			   });
			} else {
			  // Browser doesn't support Geolocation
			  handleLocationError(false, infoWindow, map.getCenter());
			}
		}
		
			var dst1;
			var dst2;
			var dst3;
			var dst4;
			var dst5;
	 function distanceToCity() {
			var pos;
			
			var distanceService = new google.maps.DistanceMatrixService();
			adressAnkara = {lat: 39.925533, lng: 32.866287};
        	distanceService.getDistanceMatrix({
                origins: [adressAnkara],
                destinations: [currentLocationn],
                travelMode: "DRIVING",
                unitSystem: google.maps.UnitSystem.METRIC,
                durationInTraffic: true,
                avoidHighways: false,
                avoidTolls: false
            },
            function (response, status) {
                if (status !== google.maps.DistanceMatrixStatus.OK) {
                    console.log('Error:', status);
                } else {
                    console.log(response);
                   //=======================Our Text View Where i Display Distance and Time Values===================
                   //document.getElementById('location2').innerHTML= "You are far from the city center " + response.rows[0].elements[0].distance.text;
					dst1 = response.rows[0].elements[0].distance.text;
                }
            });
			//*********************************************************
			distanceService = new google.maps.DistanceMatrixService();
			adressIstanbul = {lat: 41.015137, lng: 28.979530};
        	distanceService.getDistanceMatrix({
                origins: [adressIstanbul],
                destinations: [currentLocationn],
                travelMode: "DRIVING",
                unitSystem: google.maps.UnitSystem.METRIC,
                durationInTraffic: true,
                avoidHighways: false,
                avoidTolls: false
            },
            function (response, status) {
                if (status !== google.maps.DistanceMatrixStatus.OK) {
                    console.log('Error:', status);
                } else {
                    console.log(response);
                   //=======================Our Text View Where i Display Distance and Time Values===================
                    //document.getElementById('location2').innerHTML= "You are far from the city center " + response.rows[0].elements[0].distance.text;
					dst2 = response.rows[0].elements[0].distance.text;
				}
			});
			//*********************************************************
			distanceService = new google.maps.DistanceMatrixService();
			adressEskisehir = {lat: 39.766193, lng: 30.526714};
        	distanceService.getDistanceMatrix({
                origins: [adressEskisehir],
                destinations: [currentLocationn],
                travelMode: "DRIVING",
                unitSystem: google.maps.UnitSystem.METRIC,
                durationInTraffic: true,
                avoidHighways: false,
                avoidTolls: false
            },
            function (response, status) {
                if (status !== google.maps.DistanceMatrixStatus.OK) {
                    console.log('Error:', status);
                } else {
                    console.log(response);
                   //=======================Our Text View Where i Display Distance and Time Values===================
                    //document.getElementById('location2').innerHTML= "You are far from the city center " + response.rows[0].elements[0].distance.text;
					dst3 = response.rows[0].elements[0].distance.text;
				}
			});
			//*********************************************************
			distanceService = new google.maps.DistanceMatrixService();
			adressTrabzon = {lat: 41.002697, lng: 39.716763};
        	distanceService.getDistanceMatrix({
                origins: [adressTrabzon],
                destinations: [currentLocationn],
                travelMode: "DRIVING",
                unitSystem: google.maps.UnitSystem.METRIC,
                durationInTraffic: true,
                avoidHighways: false,
                avoidTolls: false
            },
            function (response, status) {
                if (status !== google.maps.DistanceMatrixStatus.OK) {
                    console.log('Error:', status);
                } else {
                    console.log(response);
                   //=======================Our Text View Where i Display Distance and Time Values===================
                    //document.getElementById('location2').innerHTML= "You are far from the city center " + response.rows[0].elements[0].distance.text;
					dst4 = response.rows[0].elements[0].distance.text;
				}
			});
			//*********************************************************
			distanceService = new google.maps.DistanceMatrixService();
			adressAdana = {lat: 37.000000, lng: 35.321335};
        	distanceService.getDistanceMatrix({
                origins: [adressAdana],
                destinations: [currentLocationn],
                travelMode: "DRIVING",
                unitSystem: google.maps.UnitSystem.METRIC,
                durationInTraffic: true,
                avoidHighways: false,
                avoidTolls: false
            },
            function (response, status) {
                if (status !== google.maps.DistanceMatrixStatus.OK) {
                    console.log('Error:', status);
                } else {
                    console.log(response);
                   //=======================Our Text View Where i Display Distance and Time Values===================
                    //document.getElementById('location2').innerHTML= "You are far from the city center " + response.rows[0].elements[0].distance.text;
					dst5 = response.rows[0].elements[0].distance.text;
				}
			});
			
			//Ankara 	39.925533,	32.866287
			//İstanbul	41.015137,	28.979530
			//Eskişehir 39.766193,	30.526714
			//Trabzon	41.002697,	39.716763
			//Adana 	37.000000,	35.321335
			setTimeout(function(){
    			//do what you need here
				var dsts = [ dst1, dst2, dst3, dst4, dst5];
				dsts.sort();
				document.getElementById('location2').innerHTML = "You are far from the city center " + dsts[0];
				//alert(dsts[0]);
			}, 2000);
			//calculateNearest();
		}
		
      function handleLocationError(browserHasGeolocation, infoWindow, pos) {
        infoWindow.setPosition(pos);
        infoWindow.setContent(browserHasGeolocation ?
                              'Error: The Geolocation service failed.' :
                              'Error: Your browser doesn\'t support geolocation.');
        infoWindow.open(map);
      }	
		
		
		function distanceToEarth() {
//			currentLocation();
//			setTimeout( 3000);
		    var distanceService = new google.maps.DistanceMatrixService();
			var adress2 = {lat: 37.688, lng: 35.438};
        distanceService.getDistanceMatrix({
                origins: [adress2],
                destinations: [currentLocationn],
                travelMode: "DRIVING",
                unitSystem: google.maps.UnitSystem.METRIC,
                durationInTraffic: true,
                avoidHighways: false,
                avoidTolls: false
            },
            function (response, status) {
                if (status !== google.maps.DistanceMatrixStatus.OK) {
                    console.log('Error:', status);
                } else {
                    console.log(response);
                   //=======================Our Text View Where i Display Distance and Time Values===================
                    document.getElementById('location3').innerHTML="You are far from the earth center " + response.rows[0].elements[0].distance.text;

                }
            });
		}
		

    </script>
    
  </body>
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAPqzTmmI91gFNPWoWloQE6Kg1PZ2fTZMQ&libraries=places&key=AIzaSyAPqzTmmI91gFNPWoWloQE6Kg1PZ2fTZMQ&callback=initMap"
    async defer></script>
</html>